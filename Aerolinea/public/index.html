<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Aerolineas EXODUS</title>



        <script type="text/javascript" src="js/Ciudad.js"></script>
        <script type="text/javascript" src="js/Vuelo.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <link href="https://fonts.googleapis.com/css?family=Amatic+SC|Cabin+Sketch|Love+Ya+Like+A+Sister" rel="stylesheet">
        <link href="css/product-carousel.css" rel="stylesheet">     
        <link rel="stylesheet" href="css/animate.css">  
        <script type="text/javascript" src="js/jquery.min.js"></script>   
        <script type="text/javascript" src="js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>
        <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
        <script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
        <link rel="stylesheet" href="https://cdn.datatables.net/1.10.15/css/jquery.dataTables.min.css">


        <link rel="stylesheet" title="normal" type="text/css" href="css/estilo.css">
        <script src="js/ddmenu.js" type="text/javascript"></script>

        <script src="http://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.0.2/js/bootstrap-datepicker.min.js"></script>
        <link rel="stylesheet" src="http://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.0.2/css/bootstrap-datepicker.min.css">
    </head>
    <body>
        <a id="ddmenuLink" href="ddmenu-source.html">Menu</a>

        <div class="container">
            <div class="panel panel-default">
                <div class="panel-body">
                    <br><br>



                    <div class="container text-center"><h1 class="titulo1">Vuelos en descuento</h1></div>
                    <div class="carousel slide row innerbkground" data-ride="carousel" data-type="multi" data-interval="3000" id="productscarousel">
                        <div class="carousel-inner" id="carousel">
                        </div>
                        <a class="left carousel-control" href="#productscarousel" data-slide="prev"><i class="glyphicon glyphicon-chevron-left"></i></a>
                        <a class="right carousel-control" href="#productscarousel" data-slide="next"><i class="glyphicon glyphicon-chevron-right"></i></a> 
                    </div>

                    <br><br>


                    <div class="container text-center"><h1 class="titulo1">Buscador de Vuelos</h1></div>



                    <div class="panel panel-default" id="panel2">

                        <div id="formularioDiv" style="display: inline-block;vertical-align:middle;">
                            <form method="POST" name="formulario" id="formulario" action="javascript:doSearch();">
                                <div>
                                    <div class="col-sm-8" >-  Origen -<br><select id="origen" ></select></div>
                                    <div class="col-sm-4">- Destino -<br><select id="destino" ></select></div>
                                    <div class="col-sm-8">-  Salida -<div class="input-append date" id="salida"  data-date-format="dd-mm-yyyy">
                                            <input class="span2" size="16" type="text" /> 
                                            <span class="add-on"><i class="icon-th"></i></span>
                                        </div></div>
                                    <div class="col-sm-4">- Llegada -<div class="input-append date" id="llegada"  data-date-format="dd-mm-yyyy">
                                            <input class="span2" size="16" type="text"  /> 
                                            <span class="add-on"><i class="icon-th"></i></span>
                                        </div></div>
                                    <div class="col-sm-8">-Pasajeros-<select id="origen" ></select></div>
                                    <div class="col-sm-4"><input class="boton" type="submit" value="Buscar"></div>
                                </div>



                            </form>





                        </div>

                    </div> 
                    <br><br>
                    <div class="panel panel-default" id="panel2">
                        <div id="listadoDiv" style="display: block; vertical-align:top;">
                            <table class="grid" id="t1">
                                <thead><tr><th>Origen</th><th>Destino</th><th>Precio</th></thead>
                                <tbody id="listado"></tbody>
                            </table>

                        </div>
                    </div>
                    <br><br><br><br><br><br><br><br><br>

                </div>





            </div>                  
        </div>



        <script> //Modell
            function AirModel() {
                this.AirModel();
            }

            AirModel.prototype = {
                AirModel: function () {
                    this.ciudades = this.initCiudades();
                    this.vuelos = this.initVuelos();
                    this.promo = this.initPromo();
                    this.buscados = [];
                },

                initCiudades: function () {
                    var ciudades = [
                        new Ciudad("SJO", "San José", "Costa Rica"),
                        new Ciudad("MIA", "Miami", "USA"),
                        new Ciudad("GYA", "Guayaquil", "Ecuador"),
                        new Ciudad("BTA", "Bogotá", "Colombia")
                    ];
                    return ciudades;
                },

                initPromo: function () {
                    var promo = [
                        new Vuelo("00001", this.ciudades[0], this.ciudades[1], 200, "L", "08:00"),
                        new Vuelo("00002", this.ciudades[1], this.ciudades[0], 300, "M", "09:00"),
                        new Vuelo("00003", this.ciudades[2], this.ciudades[3], 400, "J", "10:00"),
                        new Vuelo("00004", this.ciudades[3], this.ciudades[2], 500, "V", "11:00")
                    ];
                    return promo;
                },

                initVuelos: function () {
                    var vuelos = [
                        new Vuelo("00001", this.ciudades[0], this.ciudades[1], 200, "L", "08:00"),
                        new Vuelo("00002", this.ciudades[1], this.ciudades[0], 300, "M", "09:00"),
                        new Vuelo("00003", this.ciudades[2], this.ciudades[3], 400, "J", "10:00"),
                        new Vuelo("00004", this.ciudades[3], this.ciudades[2], 500, "V", "11:00")
                    ];
                    return vuelos;
                }





            };
        </script>
        <script> //Controller
            function AirController(model, view) {
                this.AirController(model, view);
            }

            AirController.prototype = {
                AirController: function (model, view) {
                    this.model = model;
                    this.view = view;
                },

                buscar: function () {
                    var origen = this.view.$("#origen").val();
                    var destino = this.view.$("#destino").val();
                    model.buscados = model.vuelos.filter(
                            function (v) {
                                return((v.origen.codigo == origen && v.destino.codigo == destino))}
                    );
                    this.view.showBuscados();
                }
            };
        </script>
        <script> //View
            var model;
            var controller;

            function pageLoad(event) {
                model = new AirModel();
                controller = new AirController(model, window);
                showPromos(); //llenar el carousel  
                new WOW().init();
                jQuery('.carousel[data-type="multi"] .item').each(function () {
                    var next = jQuery(this).next();
                    if (!next.length) {
                        next = jQuery(this).siblings(':first');
                    }
                    next.children(':first-child').clone().appendTo(jQuery(this));

                    for (var i = 0; i < 2; i++) {
                        next = next.next();
                        if (!next.length) {
                            next = jQuery(this).siblings(':first');
                        }
                        next.children(':first-child').clone().appendTo($(this));
                    }
                });
                $('#salida').datepicker({autoclose: true, language: 'es'});
                $('#salida').datepicker('update', new Date());
                $('#llegada').datepicker({autoclose: true, language: 'es'});
                $('#llegada').datepicker('update', new Date());
                fillCombo();

                listVuelos(model.buscados);
            }

            function showPromos() {
                for (var a = 0; a < model.promo.length; a++)
                {
                    addCarousel(model.promo[a]);
                }
            }
            function addCarousel(vuelo) {
                var c = document.getElementById("carousel");
                var item = "";
                item = c.childElementCount == 0 ? "item active" : "item";
                var a = "";
                a += "<div class=\"col-md-3 col-sm-4 col-xs-12\">";

                a += "<div class=\"spe-prods\">";
                a += "<div class=\"mainbox\">";
                a += "<h3>" + vuelo.origen.nombre + " - " + vuelo.destino.nombre + "</h3>";//encabezado de producto
                a += "<img src=\"img/" + vuelo.numero + ".jpg\" alt=\"\">";//link de imagen
                a += "</div>";
                a += "<div class=\"price-big\">";
                a += "<div>"
                a += "<div class=\"floatting-price\">";
                a += "<h3>$" + vuelo.precio + "</h3>";//precio
                a += "</div>";
                a += "</div>";
                a += "<div class=\"ordersection\">";
                a += "<a href=\"#\" class=\"buybtn\">Comprar</a>";
                a += "</div>";
                a += "</div>";
                a += "</div>";


                a += "</div>";
                var b = document.createElement("div");
                b.className = item;
                b.innerHTML = a;

                c.appendChild(b);
            }

            function fillCombo()
            {
                var origen = document.getElementById("origen");
                var destino = document.getElementById("destino");
                for (var i = 0; i < model.ciudades.length; i++) {
                    origen.options[i] = new Option(model.ciudades[i].nombre, model.ciudades[i].codigo);
                    destino.options[i] = new Option(model.ciudades[i].nombre, model.ciudades[i].codigo);
                }
            }
            function doSearch() {
                controller.buscar();
            }
            function showBuscados() {
                listVuelos();
            }

            function listVuelos() {
                table.destroy();
                var listado = document.getElementById("listado");
                listado.innerHTML = "";
                for (i = 0; i < model.buscados.length; i++) {
                    listVuelo(listado, model.buscados[i]);
                }
                table = paginacion();
            }
            var table = paginacion();
            function paginacion() {
                return $('#t1').DataTable({"language": {"sProcessing": "Procesando...",
                        "sLengthMenu": "Mostrar _MENU_ boletos",
                        "sZeroRecords": "No se encontraron resultados",
                        "sEmptyTable": "Ningún dato disponible en esta tabla",
                        "sInfo": "Mostrando boletos del _START_ al _END_ de un total de _TOTAL_ boletos",
                        "sInfoEmpty": "Mostrando boletos del 0 al 0 de un total de 0 boletos",
                        "sInfoFiltered": "(filtrado de un total de _MAX_ boletos)",
                        "sInfoPostFix": "",
                        "sSearch": "Buscar:",
                        "sUrl": "",
                        "sInfoThousands": ",",
                        "sLoadingRecords": "Cargando...",
                        "oPaginate": {
                            "sFirst": "Primero",
                            "sLast": "Último",
                            "sNext": "Siguiente",
                            "sPrevious": "Anterior"
                        },
                        "oAria": {
                            "sSortAscending": ": Activar para ordenar la columna de manera ascendente",
                            "sSortDescending": ": Activar para ordenar la columna de manera descendente"
                        }
                    }});
                return t2;
            }
            function listVuelo(listado, vuelo) {
                var tr = document.createElement("tr");
                var td;
                td = document.createElement("td");
                td.appendChild(document.createTextNode(vuelo.origen.nombre));
                tr.appendChild(td);
                td = document.createElement("td");
                td.appendChild(document.createTextNode(vuelo.destino.nombre));
                tr.appendChild(td);
                td = document.createElement("td");
                td.appendChild(document.createTextNode(vuelo.precio));
                tr.appendChild(td);
                listado.appendChild(tr);
            }

            document.addEventListener("DOMContentLoaded", pageLoad)
        </script>


    </body>
</html>
